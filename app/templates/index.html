{% extends "layout/base.html" %}

{% block head %}
<style>
    body {overflow-y: auto;}
    #top {margin-top: 60px;}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row-fluid">
    <div class="col-md-3" style="height: 600px;overflow-y: auto;margin-top: 60px">
        <div>    
            <p>
            <center>
            <h1>Steal This House!</h1>
            </p>
        </div>

        <form role="form" action="/out" method="POST">
            <div class="form-group">
                <br>
                <center>
                <label class="control-label" for="onlyform">ENTER AN ADDRESS: </label>
                <input class="form-control" type="text" name="searchPhrase" placeholder="e.g. 1249 18th Ave" id="onlyform">
                <input class="btn btn-danger btn-lg btn-block" type="submit">
            </div>
        
            <div class="bg-danger" align="center" style="margin-top: 20px;">
                <label class="radio-inline">
                  <input checked type="radio" name="inlineRadioOptions"  id="inlineRadio1" value="none"> None
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="housedb"> Price
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" id="inlineRadio3" value="crimedb"> Crime
                </label>
            </div>

            <div class="year-selector" align="center" style="margin-top: 20px;">
                <select class="form-control" id="dropdown" name="dd_year">
                  <option value="99">Select Year...</option>
                  <option value="2014">2014</option>
                  <option value="2013">2013</option>
                  <option value="2012">2012</option>
                  <option value="2011">2011</option>
                </select>
            </div>

            <div class="month-selector" align="center" style="margin-top: 20px;">
                <select class="form-control" id="dropdown" name="dd_month">
                  <option value="99">Select Month...</option>
                  <option value="1">Jan</option>
                  <option value="2">Feb</option>
                  <option value="3">Mar</option>
                  <option value="4">Apr</option>
                  <option value="5">May</option>
                  <option value="6">Jun</option>
                  <option value="7">Jul</option>
                  <option value="8">Aug</option>
                  <option value="9">Sep</option>
                  <option value="10">Oct</option>
                  <option value="11">Nov</option>
                  <option value="12">Dec</option>
                </select>
            </div>

        </form>

        <div>
            <center>
                {% if t_dat %}
                    <div>
                        <p class="bg-danger" style="margin-top: 20px;">{{t_dat}}</p>
                    </div>
                {% endif %}
                <img class="img-responsive img-rounded" src="{{ url_for('getPlot',id_num = ind) }}" style="margin-left:auto;margin-right:auto; margin-top: 20px;"/>
            </center>
        </div>

    </div>
    <div class="col-md-9">
        <hr>
        <script type="text/javascript" src="//maps.google.com/maps/api/js?sensor=false&key=AIzaSyCJC3IiY1qVYpksDJ4GnS1C2LwKaOrFazM&libraries=geometry,visualization"></script>
        <script type="text/javascript">


        function initialize() {
            var mapDiv = document.getElementById('map-canvas');
            var map = new google.maps.Map(mapDiv, {
                center: new google.maps.LatLng(37.7563659, -122.4496905),
                zoom: 12,
                mapTypeId: google.maps.MapTypeId.ROADMAP
                });
        
            {% if valid %}
                var content_string = '<p style="overflow: auto;"><span style="float: left;width: 80px; margin-top: 10px;margin-left: 10px;verticle-align:middle;">PREDICTED CHANGE OF <strong>${{vals}}</strong> IN 3 MONTHS ({{civ}}% CI)</span>  <img style="float:left;" src="{{z_str}}"></p>'

                var infoWindow = new google.maps.InfoWindow({
                    position: new google.maps.LatLng({{la_data}}, {{lo_data}}),
                    content: content_string
                    });
                infoWindow.open(map);
            {% endif %}


            var sfpat = [new google.maps.LatLng(37.809812,-122.476634),
                new google.maps.LatLng(37.797346,-122.481910),
                new google.maps.LatLng(37.788471,-122.490044),
                new google.maps.LatLng(37.786681,-122.496047),
                new google.maps.LatLng(37.787849,-122.502443),
                new google.maps.LatLng(37.785374,-122.510171),
                new google.maps.LatLng(37.780344,-122.514118),
                new google.maps.LatLng(37.772203,-122.514577),
                new google.maps.LatLng(37.708283,-122.503009),
                new google.maps.LatLng(37.707944,-122.391354),
                new google.maps.LatLng(37.708315,-122.380821),
                new google.maps.LatLng(37.716061,-122.375920),
                new google.maps.LatLng(37.715668,-122.365390),
                new google.maps.LatLng(37.728642,-122.358034),
                new google.maps.LatLng(37.739688,-122.368804),
                new google.maps.LatLng(37.753637,-122.378594),
                new google.maps.LatLng(37.788308,-122.387641),
                new google.maps.LatLng(37.807490,-122.404791),
                new google.maps.LatLng(37.810019,-122.415333),
                new google.maps.LatLng(37.804758,-122.462631),
                new google.maps.LatLng(37.807265,-122.468261)];

            var shape = new google.maps.Polygon({
                paths: sfpat,
                strokeColor: '#ff0000',
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillColor: '#66ff00',
                fillOpacity: 0.001
                });
        
            shape.setMap(map);

            {% if plot_heat %}
                var map_dat = [
                    {% for line in heat_data %}
                         [{{line[0]}},{{line[1]}},{{line[2]}}],
                    {% endfor %}
                    ];

                var heatmapData = [];

                for (i = 0; i < map_dat.length; i++) {
                  var latLng = new google.maps.LatLng(map_dat[i][0],map_dat[i][1]);
                  var magnitude = map_dat[i][2];
                  var weightedLoc = {
                    location: latLng,
                    weight: magnitude
                    };
                  heatmapData.push(weightedLoc);
                };

                var heatmap = new google.maps.visualization.HeatmapLayer({
                      data: heatmapData,
                      radius: 35,
                      dissipating: 1,
                      opacity: 0.7,
                    });

                heatmap.setMap(map);
            {% endif %}

            }

        google.maps.event.addDomListener(window, 'load', initialize);
        </script> 

        <div id="map-canvas" style="width: 100%; height: 600px;margin-left:auto;margin-right:auto;margin-top: 60px;overflow-y: auto;">
        </div>


    </div>
  </div>
</div>

{% endblock %}

{% block footer %}
  {% include "include/footer.html" %}
{% endblock %}


{% block scripts %}


{% endblock %}